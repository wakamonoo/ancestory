<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      property="og:title"
      content="AnceStory - Where ancestral whispers become timeless tales!"
    />
    <meta
      property="og:description"
      content="Discover and share ancestral stories from all around the globe"
    />
    <meta property="og:image" content="https://i.imgur.com/DxymniP.png" />
    <meta property="og:url" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="AnceStory" />
    <title>Story Details</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="storyDetail.css">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"
    />
    <style>
      .noteModal {
        margin: 10px auto;
        color: #20462f;
        font-size: 12;
      }

      .noteModal span {
        color: #f7f7f7;
        font-weight: 600;
      }

      .highlight-word {
        background-color: #d5c7a3;
        color: #20462f;
        padding: 2px 0;
        border-radius: 5px;
        transition: all 0.1s ease;
        position: relative;
      }

      #speech-controls {
        margin: 5px auto;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 8px;
        margin-bottom: 5%;
        margin-top: 2%;
        background-color: #f7f7f7;
        border-radius: 30px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        max-width: 600px;
      }

      #speech-controls button {
        background-color: #20462f;
        color: #f1d1b5;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 16px;
        transition: background-color 0.3s ease, transform 0.2s ease-in-out;
        width: 100%;
        justify-content: center;
      }

      #speech-controls button:hover {
        background-color: #2d5a3d;
        transform: scale(1.05);
      }

      #speech-controls button i {
        font-size: 18px;
      }

      #speech-options-btn {
        background-color: #d5c7a3;
        color: #20462f;
      }

      #speech-options-btn:hover {
        background-color: #c7b794;
      }

      /* Modal container - CENTERED */
      .modal {
        justify-content: center;
        align-items: center;
        position: fixed;
        inset: 0;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
      }

      /* Modal content */
      .modal-content {
        background-color: #c09779;
        padding: 30px;
        border-radius: 15px;
        max-width: 500px;
        width: 90%;
        color: #20462f;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      }

      .modal-content h3 {
        color: #f7f7f7;
      }

      /* Modal close button */
      .close-modal {
        color: #20462f;
        float: right;
        font-size: 30px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.2s ease;
      }

      .close-modal:hover {
        color: #33614a;
      }

      /* Modal form controls */
      .modal-control {
        margin-bottom: 20px;
      }

      .modal-control label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #f7f7f7;
      }

      .modal-control select,
      .modal-control input[type="range"] {
        width: calc(100% - 16px);
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #d5c7a3;
        background-color: #f7f7f7;
        font-size: 16px;
        color: #20462f;
      }

      /* Apply button */
      #apply-speech-options {
        background-color: #f1d1b5;
        color: #f7f7f7;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s ease, transform 0.2s ease-in-out;
        width: 100%;
      }

      #apply-speech-options:hover {
        background-color: #d5c7a3;
        transform: scale(1.02);
      }

      #rate-value {
        display: inline-block;
        width: 40px;
        text-align: center;
        margin-left: 10px;
        color: #33614a;
      }

      /* Responsive adjustments */
      @media (max-width: 1200px), (max-width: 600px) {
        #speech-controls {
          flex-direction: column;
          align-items: stretch;
          gap: 10px;
          padding: 8px;
          max-width: 95%;
          margin: 20px auto;
        }

        #speech-controls button {
          width: 100%;
          justify-content: center;
          font-size: 14px;
          padding: 8px 15px;
        }

        #speech-controls button i {
          font-size: 16px;
        }

        .modal-content {
          width: 90%;
          padding: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div id="storyContent">
      <div id="storyContainer">
        <div id="containerMenu">
          <a href="index.html#stories" class="back-button" aria-label="Go back">
            <i class="fas fa-arrow-left"></i>
          </a>
          <div class="toggleContainer">
            <label class="switch">
              <input id="translate-toggle" class="togglesw" type="checkbox" />
              <div class="indicator left">ENG</div>
              <div class="indicator right">FIL</div>
              <div class="button"></div>
            </label>
          </div>
        </div>
        <h1 id="story-title">Story Title</h1>
        <p id="story-origin">Origin:</p>
        <img id="story-image" alt="Story Image" />
        <div id="speech-controls">
          <button id="speak-btn" aria-label="Read story aloud">
            <i class="fas fa-volume-up"></i>
            <span>Listen</span>
          </button>
          <button
            id="stop-speech-btn"
            aria-label="Stop reading"
            style="display: none"
          >
            <i class="fas fa-stop"></i>
            <span>Stop</span>
          </button>
        </div>
        <div id="story-content"></div>

        <!-- Inline Reaction Section -->
        <div class="reaction-section">
          <div class="reaction-stats">
            <i class="fas fa-thumbs-up"></i>
            <span id="like-count">0 reactions</span>
          </div>
          <div class="reaction-stats">
            <span id="comment-count">0 comments</span>
            <span style="margin: 0 5px">•</span>
            <span id="share-count">0 shares</span>
          </div>
        </div>

        <div class="reaction-actions">
          <div class="reaction-container">
            <div class="reaction-action like-btn">
              <i class="fas fa-thumbs-up"></i>
              <span>Like</span>
            </div>
            <div class="reaction-options">
              <div class="reaction-option" data-reaction="like" title="Like">
                <i class="fas fa-thumbs-up" style="color: #216fdb"></i>
              </div>
              <div class="reaction-option" data-reaction="love" title="Love">
                <i class="fas fa-heart" style="color: #f33e58"></i>
              </div>
              <div class="reaction-option" data-reaction="wow" title="Wow">
                <i class="fas fa-surprise" style="color: #f7b125"></i>
              </div>
              <div class="reaction-option" data-reaction="angry" title="Angry">
                <i class="fas fa-angry" style="color: #e9710f"></i>
              </div>
            </div>
          </div>

          <div class="reaction-action comment-btn">
            <i class="fas fa-comment-dots"></i>
            <span>Comment</span>
          </div>

          <div class="reaction-action share-btn">
            <i class="fas fa-share"></i>
            <span>Share</span>
          </div>
        </div>

        <div class="comment-section">
          <div class="comment-box" id="comment-form">
            <div class="comment-input-container">
              <input
                type="text"
                id="comment-input"
                placeholder="Write a comment..."
              />
            </div>
            <button id="post-comment">Post</button>
          </div>

          <div id="comments-section"></div>
        </div>
      </div>
    </div>

    <!-- Speech Options Modal -->
    <div id="speech-options-modal" class="modal">
      <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h3>Speech Options</h3>
        <p class="noteModal">
          <span>Note:</span>The voice model and highlight function is based on
          the compatibily of your device and browser, this best work for pc but
          still work cross devices. <br /><br />
          <span>Best Voice Model</span><br />ENG - Andrew | Emma <br />
          FIL - Angelo | Blessica
        </p>
        <div class="modal-control">
          <label for="voice-select-modal">Voice:</label>
          <select id="voice-select-modal"></select>
        </div>
        <div class="modal-control">
          <label for="rate-control-modal">Speed:</label>
          <input
            type="range"
            id="rate-control-modal"
            min="0.5"
            max="2"
            step="0.1"
            value="1"
          />
          <span id="rate-value">1.0x</span>
        </div>
        <button id="apply-speech-options">Apply</button>
      </div>
    </div>

    <script type="module" src="storyDetail.js"></script>
    <script>
      // Get elements
      const speakBtn = document.getElementById("speak-btn");
      const stopSpeechBtn = document.getElementById("stop-speech-btn");
      const speechOptionsModal = document.getElementById(
        "speech-options-modal"
      );
      const closeModalBtn = document.querySelector(".close-modal");

      // Event listener for the 'Listen' button
      speakBtn.addEventListener("click", function () {
        // Show SweetAlert first
        showCompatibilityAlert();
      });

      // Function to show SweetAlert
      function showCompatibilityAlert() {
        Swal.fire({
          title: "Important Notice!",
          text: "The voice model and text-highlighting features are optimized for desktop browsers. Some features may not work as expected on your device. You can change the TTS settings from your device’s accessibility options for better experience.",
          icon: "info",
          showCancelButton: true,
          confirmButtonText: "Proceed to Speech Options",
          cancelButtonText: "Cancel",
        }).then((result) => {
          if (result.isConfirmed) {
            // Open the speech options modal only if the user confirms
            speechOptionsModal.style.display = "flex";
          }
        });
      }

      // Event listener for closing the modal
      closeModalBtn.addEventListener("click", function () {
        speechOptionsModal.style.display = "none";
      });

      // Optional: Close modal when clicking outside of it
      window.addEventListener("click", function (event) {
        if (event.target === speechOptionsModal) {
          speechOptionsModal.style.display = "none";
        }
      });
    </script>
  </body>
</html>
